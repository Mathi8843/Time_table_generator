<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timetable Generator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .form-section {
            margin-bottom: 20px;
        }
        .input-group {
            margin: 10px 0;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        button {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        #timetable-output {
            display: none;
        }
    </style>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Timetable Generator</h1>
    <form id="timetable-form">
        <div class="form-section">
            <h2>Basic Information</h2>
            <div class="input-group">
                <label for="class-names">Class Names (space-separated):</label><br>
                <input type="text" id="class-names" name="class-names" required>
            </div>
            <div class="input-group">
                <label for="periods-per-day">Number of Hours per Day (including breaks and lunch):</label><br>
                <input type="number" id="periods-per-day" name="periods-per-day" min="1" required>
            </div>
            <div class="input-group">
                <label for="num-breaks">Number of Breaks:</label><br>
                <input type="number" id="num-breaks" name="num-breaks" min="0" required>
            </div>
            <div id="break-periods"></div>
            <div class="input-group">
                <label for="lunch-period">Lunch Period Number (1-based):</label><br>
                <input type="number" id="lunch-period" name="lunch-period" min="1" required>
            </div>
            <div class="input-group">
                <label for="break-duration">Duration for Each Break (minutes):</label><br>
                <input type="number" id="break-duration" name="break-duration" min="1" required>
            </div>
            <div class="input-group">
                <label for="lunch-duration">Duration for Lunch (minutes):</label><br>
                <input type="number" id="lunch-duration" name="lunch-duration" min="1" required>
            </div>
            <div id="period-durations"></div>
        </div>

        <div class="form-section" id="subjects-section">
            <h2>Subjects</h2>
            <!-- Dynamically added subject inputs -->
        </div>

        <div class="form-section">
            <h2>Staff</h2>
            <div class="input-group">
                <label for="num-staff">Number of Staff Members:</label><br>
                <input type="number" id="num-staff" name="num-staff" min="1" required>
            </div>
            <div id="staff-details"></div>
        </div>

        <div class="form-section">
            <h2>Special Hours</h2>
            <div class="input-group">
                <label for="num-special">Number of Special Hours (e.g., library):</label><br>
                <input type="number" id="num-special" name="num-special" min="0" required>
            </div>
            <div id="special-hours"></div>
        </div>

        <button type="button" onclick="generateTimetable()">Generate Timetable</button>
    </form>

    <div id="timetable-output">
        <h2>Generated Timetable</h2>
        <div id="timetable-tables"></div>
    </div>

    <script>
        // Dynamically generate break period inputs
        document.getElementById('num-breaks').addEventListener('change', function() {
            const numBreaks = parseInt(this.value);
            const breakPeriodsDiv = document.getElementById('break-periods');
            breakPeriodsDiv.innerHTML = '';
            for (let i = 0; i < numBreaks; i++) {
                breakPeriodsDiv.innerHTML += `
                    <div class="input-group">
                        <label>Break ${i + 1} Period Number (1-based):</label><br>
                        <input type="number" name="break-period-${i}" min="1" required>
                    </div>`;
            }
        });

        // Dynamically generate period duration inputs
        document.getElementById('periods-per-day').addEventListener('change', function() {
            const periods = parseInt(this.value);
            const durationsDiv = document.getElementById('period-durations');
            durationsDiv.innerHTML = '<h3>Period Durations</h3>';
            for (let i = 0; i < periods; i++) {
                durationsDiv.innerHTML += `
                    <div class="input-group">
                        <label>Duration for Period ${i + 1} (minutes):</label><br>
                        <input type="number" name="period-duration-${i}" min="1" disabled>
                    </div>`;
            }
        });

        // Update period durations based on break and lunch
        function updatePeriodDurations() {
            const periods = parseInt(document.getElementById('periods-per-day').value);
            const breakDuration = parseInt(document.getElementById('break-duration').value);
            const lunchDuration = parseInt(document.getElementById('lunch-duration').value);
            const breakPeriods = Array.from(document.getElementsByName(/^break-period-\d$/)).map(input => parseInt(input.value) - 1);
            const lunchPeriod = parseInt(document.getElementById('lunch-period').value) - 1;

            for (let i = 0; i < periods; i++) {
                const input = document.getElementsByName(`period-duration-${i}`)[0];
                if (breakPeriods.includes(i)) {
                    input.value = breakDuration;
                    input.disabled = true;
                } else if (i === lunchPeriod) {
                    input.value = lunchDuration;
                    input.disabled = true;
                } else {
                    input.disabled = false;
                }
            }
        }

        document.getElementById('break-duration').addEventListener('change', updatePeriodDurations);
        document.getElementById('lunch-duration').addEventListener('change', updatePeriodDurations);
        document.getElementById('num-breaks').addEventListener('change', updatePeriodDurations);
        document.getElementById('lunch-period').addEventListener('change', updatePeriodDurations);

        // Dynamically generate subject inputs
        document.getElementById('class-names').addEventListener('change', function() {
            const classNames = this.value.split(' ').filter(name => name);
            const subjectsSection = document.getElementById('subjects-section');
            subjectsSection.innerHTML = '<h2>Subjects</h2>';
            classNames.forEach(cls => {
                subjectsSection.innerHTML += `
                    <div class="input-group">
                        <label>Number of Subjects for ${cls}:</label><br>
                        <input type="number" name="num-subjects-${cls}" min="1" required onchange="addSubjectInputs('${cls}', this.value)">
                    </div>
                    <div id="subjects-${cls}"></div>`;
            });
        });

        function addSubjectInputs(className, numSubjects) {
            const subjectsDiv = document.getElementById(`subjects-${className}`);
            subjectsDiv.innerHTML = '';
            for (let i = 0; i < numSubjects; i++) {
                subjectsDiv.innerHTML += `
                    <div class="input-group">
                        <label>Subject ${i + 1} for ${className}</label><br>
                        <input type="text" name="subject-name-${className}-${i}" placeholder="Name" required>
                        <input type="number" name="subject-hours-${className}-${i}" placeholder="Total Hours" min="1" required>
                        <select name="subject-lab-${className}-${i}">
                            <option value="n">No Lab</option>
                            <option value="y">Has Lab</option>
                        </select>
                    </div>`;
            }
        }

        // Dynamically generate staff inputs
        document.getElementById('num-staff').addEventListener('change', function() {
            const numStaff = parseInt(this.value);
            const staffDiv = document.getElementById('staff-details');
            staffDiv.innerHTML = '';
            for (let i = 0; i < numStaff; i++) {
                staffDiv.innerHTML += `
                    <div class="input-group">
                        <label>Staff ${i + 1}</label><br>
                        <input type="text" name="staff-name-${i}" placeholder="Name" required>
                        <input type="text" name="staff-subjects-${i}" placeholder="Subjects (comma-separated)" required>
                        <input type="number" name="staff-max-hours-${i}" placeholder="Max Hours/Day" min="1" required>
                    </div>`;
            }
        });

        // Dynamically generate special hours inputs
        document.getElementById('num-special').addEventListener('change', function() {
            const numSpecial = parseInt(this.value);
            const specialDiv = document.getElementById('special-hours');
            specialDiv.innerHTML = '';
            for (let i = 0; i < numSpecial; i++) {
                specialDiv.innerHTML += `
                    <div class="input-group">
                        <label>Special Hour ${i + 1}</label><br>
                        <input type="text" name="special-name-${i}" placeholder="Name" required>
                        <input type="number" name="special-hours-${i}" placeholder="Hours Required" min="1" required>
                    </div>`;
            }
        });

        // Generate timetable (mock implementation)
        function generateTimetable() {
            // Normally, this would send data to a backend (e.g., Flask) to run the Python code
            // For demo, we'll use your sample output directly
            const timetableOutput = document.getElementById('timetable-output');
            const timetableTables = document.getElementById('timetable-tables');
            timetableTables.innerHTML = '';

            // Sample timetable data (from your previous output)
            const timetableData = {
                "ClassA": {
                    "Monday": ["Physics (lab)", "Physics (lab)", "", "English (lecture) - p2", "Math (lecture) - p1", "", "", "", ""],
                    "Tuesday": ["", "", "", "Physics (lecture) - p1", "Physics (lecture) - p1", "", "", "", "Math (lecture) - p1"],
                    "Wednesday": ["Library (special)", "Math (lecture) - p1", "", "", "", "", "English (lecture) - p2", "", "English (lecture) - p2"],
                    "Thursday": ["Math (lecture) - p1", "", "", "", "", "", "", "", ""],
                    "Friday": ["", "English (lecture) - p2", "", "Library (special)", "Math (lecture) - p1", "", "Math (lecture) - p1", "", ""]
                },
                "ClassB": {
                    "Monday": ["Chemistry (lab)", "Chemistry (lab)", "", "", "", "", "", "", ""],
                    "Tuesday": ["Library (special)", "Library (special)", "", "Biology (lecture) - chemistry,biology", "", "", "History (lecture) - p2", "", ""],
                    "Wednesday": ["", "Biology (lecture) - chemistry,biology", "", "", "Chemistry (lecture) - chemistry,biology", "", "Biology (lecture) - chemistry,biology", "", ""],
                    "Thursday": ["History (lecture) - p2", "Chemistry (lecture) - chemistry,biology", "", "", "", "", "Biology (lecture) - chemistry,biology", "", "History (lecture) - p2"],
                    "Friday": ["", "Biology (lecture) - chemistry,biology", "", "Biology (lecture) - chemistry,biology", "History (lecture) - p2", "", "", "", ""]
                }
            };

            for (const [className, schedule] of Object.entries(timetableData)) {
                let tableHTML = `<h3>${className} Timetable</h3><table><tr><th>Period</th><th>Monday</th><th>Tuesday</th><th>Wednesday</th><th>Thursday</th><th>Friday</th></tr>`;
                for (let i = 0; i < 9; i++) {
                    tableHTML += `<tr><td>${i + 1}</td>`;
                    tableHTML += `<td>${schedule["Monday"][i] || ""}</td>`;
                    tableHTML += `<td>${schedule["Tuesday"][i] || ""}</td>`;
                    tableHTML += `<td>${schedule["Wednesday"][i] || ""}</td>`;
                    tableHTML += `<td>${schedule["Thursday"][i] || ""}</td>`;
                    tableHTML += `<td>${schedule["Friday"][i] || ""}</td>`;
                    tableHTML += `</tr>`;
                }
                tableHTML += `</table>`;
                timetableTables.innerHTML += tableHTML;
            }

            timetableOutput.style.display = 'block';
        }
    </script>
</body>
</html>